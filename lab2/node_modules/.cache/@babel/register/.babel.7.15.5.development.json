{
  "{\"assumptions\":{},\"sourceRoot\":\"/home/vinah331/Desktop/tdp013/lab2/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/vinah331/Desktop/tdp013/lab2\",\"filename\":\"/home/vinah331/Desktop/tdp013/lab2/app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/vinah331/Desktop/tdp013/lab2\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.15.5": {
    "metadata": {},
    "options": {
      "assumptions": {},
      "sourceRoot": "/home/vinah331/Desktop/tdp013/lab2/",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/home/vinah331/Desktop/tdp013/lab2",
      "filename": "/home/vinah331/Desktop/tdp013/lab2/app.js",
      "targets": {},
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "browserslistConfigFile": false,
      "envName": "development",
      "root": "/home/vinah331/Desktop/tdp013/lab2",
      "rootMode": "root",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/home/vinah331/Desktop/tdp013/lab2/app.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "/home/vinah331/Desktop/tdp013/lab2/app.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/home/vinah331/Desktop/tdp013/lab2/",
        "sourceFileName": "app.js"
      }
    },
    "ast": null,
    "code": "var createError = require('http-errors');\n\nvar express = require('express');\n\nvar path = require('path');\n\nvar cookieParser = require('cookie-parser');\n\nvar logger = require('morgan');\n\nvar indexRouter = require('./routes/index');\n\nvar usersRouter = require('./routes/users');\n\nvar app = express(); // view engine setup\n\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'jade');\napp.use(logger('dev'));\napp.use(express.json());\napp.use(express.urlencoded({\n  extended: false\n}));\napp.use(cookieParser());\napp.use(express.static(path.join(__dirname, 'public')));\napp.use('/', indexRouter);\napp.use('/users', usersRouter); // catch 404 and forward to error handler\n\napp.use(function (req, res, next) {\n  next(createError(404));\n}); // error handler\n\napp.use(function (err, req, res, next) {\n  // set locals, only providing error in development\n  res.locals.message = err.message;\n  res.locals.error = req.app.get('env') === 'development' ? err : {}; // render the error page\n\n  res.status(err.status || 500);\n  res.render('error');\n});\nmodule.exports = app;\n\nconst {\n  MongoClient\n} = require('mongodb');\n\nlet url = \"mongodb://localhost:27017/\";\n/*MongoClient.connect(url, (err, db) => {\n    if(err) { throw err; }\n    let dbo = db.db(\"tdp013\");\n    dbo.collection(\"movie\").find({}).toArray((err, result) => {\n      if(err){ throw err; }\n      console.log(result);\n    });\n    // close connection when done with mongo\n    db.close()\n }); */\n\nlet server = app.listen(8888, () => {\n  let host = server.address().address;\n  let port = server.address().port;\n  console.log(`Lyssnar på http://${host}:${port}`);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJjcmVhdGVFcnJvciIsInJlcXVpcmUiLCJleHByZXNzIiwicGF0aCIsImNvb2tpZVBhcnNlciIsImxvZ2dlciIsImluZGV4Um91dGVyIiwidXNlcnNSb3V0ZXIiLCJhcHAiLCJzZXQiLCJqb2luIiwiX19kaXJuYW1lIiwidXNlIiwianNvbiIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsInN0YXRpYyIsInJlcSIsInJlcyIsIm5leHQiLCJlcnIiLCJsb2NhbHMiLCJtZXNzYWdlIiwiZXJyb3IiLCJnZXQiLCJzdGF0dXMiLCJyZW5kZXIiLCJtb2R1bGUiLCJleHBvcnRzIiwiTW9uZ29DbGllbnQiLCJ1cmwiLCJzZXJ2ZXIiLCJsaXN0ZW4iLCJob3N0IiwiYWRkcmVzcyIsInBvcnQiLCJjb25zb2xlIiwibG9nIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxXQUFXLEdBQUdDLE9BQU8sQ0FBQyxhQUFELENBQXpCOztBQUNBLElBQUlDLE9BQU8sR0FBR0QsT0FBTyxDQUFDLFNBQUQsQ0FBckI7O0FBQ0EsSUFBSUUsSUFBSSxHQUFHRixPQUFPLENBQUMsTUFBRCxDQUFsQjs7QUFDQSxJQUFJRyxZQUFZLEdBQUdILE9BQU8sQ0FBQyxlQUFELENBQTFCOztBQUNBLElBQUlJLE1BQU0sR0FBR0osT0FBTyxDQUFDLFFBQUQsQ0FBcEI7O0FBRUEsSUFBSUssV0FBVyxHQUFHTCxPQUFPLENBQUMsZ0JBQUQsQ0FBekI7O0FBQ0EsSUFBSU0sV0FBVyxHQUFHTixPQUFPLENBQUMsZ0JBQUQsQ0FBekI7O0FBRUEsSUFBSU8sR0FBRyxHQUFHTixPQUFPLEVBQWpCLEMsQ0FFQTs7QUFDQU0sR0FBRyxDQUFDQyxHQUFKLENBQVEsT0FBUixFQUFpQk4sSUFBSSxDQUFDTyxJQUFMLENBQVVDLFNBQVYsRUFBcUIsT0FBckIsQ0FBakI7QUFDQUgsR0FBRyxDQUFDQyxHQUFKLENBQVEsYUFBUixFQUF1QixNQUF2QjtBQUVBRCxHQUFHLENBQUNJLEdBQUosQ0FBUVAsTUFBTSxDQUFDLEtBQUQsQ0FBZDtBQUNBRyxHQUFHLENBQUNJLEdBQUosQ0FBUVYsT0FBTyxDQUFDVyxJQUFSLEVBQVI7QUFDQUwsR0FBRyxDQUFDSSxHQUFKLENBQVFWLE9BQU8sQ0FBQ1ksVUFBUixDQUFtQjtBQUFFQyxFQUFBQSxRQUFRLEVBQUU7QUFBWixDQUFuQixDQUFSO0FBQ0FQLEdBQUcsQ0FBQ0ksR0FBSixDQUFRUixZQUFZLEVBQXBCO0FBQ0FJLEdBQUcsQ0FBQ0ksR0FBSixDQUFRVixPQUFPLENBQUNjLE1BQVIsQ0FBZWIsSUFBSSxDQUFDTyxJQUFMLENBQVVDLFNBQVYsRUFBcUIsUUFBckIsQ0FBZixDQUFSO0FBRUFILEdBQUcsQ0FBQ0ksR0FBSixDQUFRLEdBQVIsRUFBYU4sV0FBYjtBQUNBRSxHQUFHLENBQUNJLEdBQUosQ0FBUSxRQUFSLEVBQWtCTCxXQUFsQixFLENBR0E7O0FBQ0FDLEdBQUcsQ0FBQ0ksR0FBSixDQUFRLFVBQVNLLEdBQVQsRUFBY0MsR0FBZCxFQUFtQkMsSUFBbkIsRUFBeUI7QUFDL0JBLEVBQUFBLElBQUksQ0FBQ25CLFdBQVcsQ0FBQyxHQUFELENBQVosQ0FBSjtBQUNELENBRkQsRSxDQUlBOztBQUNBUSxHQUFHLENBQUNJLEdBQUosQ0FBUSxVQUFTUSxHQUFULEVBQWNILEdBQWQsRUFBbUJDLEdBQW5CLEVBQXdCQyxJQUF4QixFQUE4QjtBQUNwQztBQUNBRCxFQUFBQSxHQUFHLENBQUNHLE1BQUosQ0FBV0MsT0FBWCxHQUFxQkYsR0FBRyxDQUFDRSxPQUF6QjtBQUNBSixFQUFBQSxHQUFHLENBQUNHLE1BQUosQ0FBV0UsS0FBWCxHQUFtQk4sR0FBRyxDQUFDVCxHQUFKLENBQVFnQixHQUFSLENBQVksS0FBWixNQUF1QixhQUF2QixHQUF1Q0osR0FBdkMsR0FBNkMsRUFBaEUsQ0FIb0MsQ0FLcEM7O0FBQ0FGLEVBQUFBLEdBQUcsQ0FBQ08sTUFBSixDQUFXTCxHQUFHLENBQUNLLE1BQUosSUFBYyxHQUF6QjtBQUNBUCxFQUFBQSxHQUFHLENBQUNRLE1BQUosQ0FBVyxPQUFYO0FBQ0QsQ0FSRDtBQVVBQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJwQixHQUFqQjs7QUFFQSxNQUFNO0FBQUNxQixFQUFBQTtBQUFELElBQWdCNUIsT0FBTyxDQUFDLFNBQUQsQ0FBN0I7O0FBQ0EsSUFBSTZCLEdBQUcsR0FBRyw0QkFBVjtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLElBQUlDLE1BQU0sR0FBR3ZCLEdBQUcsQ0FBQ3dCLE1BQUosQ0FBVyxJQUFYLEVBQWlCLE1BQU07QUFDbEMsTUFBSUMsSUFBSSxHQUFHRixNQUFNLENBQUNHLE9BQVAsR0FBaUJBLE9BQTVCO0FBQ0EsTUFBSUMsSUFBSSxHQUFHSixNQUFNLENBQUNHLE9BQVAsR0FBaUJDLElBQTVCO0FBQ0FDLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFhLHFCQUFvQkosSUFBSyxJQUFHRSxJQUFLLEVBQTlDO0FBQ0EsQ0FKVyxDQUFiIiwic291cmNlUm9vdCI6Ii9ob21lL3ZpbmFoMzMxL0Rlc2t0b3AvdGRwMDEzL2xhYjIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGNyZWF0ZUVycm9yID0gcmVxdWlyZSgnaHR0cC1lcnJvcnMnKTtcbnZhciBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xudmFyIHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG52YXIgY29va2llUGFyc2VyID0gcmVxdWlyZSgnY29va2llLXBhcnNlcicpO1xudmFyIGxvZ2dlciA9IHJlcXVpcmUoJ21vcmdhbicpO1xuXG52YXIgaW5kZXhSb3V0ZXIgPSByZXF1aXJlKCcuL3JvdXRlcy9pbmRleCcpO1xudmFyIHVzZXJzUm91dGVyID0gcmVxdWlyZSgnLi9yb3V0ZXMvdXNlcnMnKTtcblxudmFyIGFwcCA9IGV4cHJlc3MoKTtcblxuLy8gdmlldyBlbmdpbmUgc2V0dXBcbmFwcC5zZXQoJ3ZpZXdzJywgcGF0aC5qb2luKF9fZGlybmFtZSwgJ3ZpZXdzJykpO1xuYXBwLnNldCgndmlldyBlbmdpbmUnLCAnamFkZScpO1xuXG5hcHAudXNlKGxvZ2dlcignZGV2JykpO1xuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XG5hcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiBmYWxzZSB9KSk7XG5hcHAudXNlKGNvb2tpZVBhcnNlcigpKTtcbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMocGF0aC5qb2luKF9fZGlybmFtZSwgJ3B1YmxpYycpKSk7XG5cbmFwcC51c2UoJy8nLCBpbmRleFJvdXRlcik7XG5hcHAudXNlKCcvdXNlcnMnLCB1c2Vyc1JvdXRlcik7XG5cblxuLy8gY2F0Y2ggNDA0IGFuZCBmb3J3YXJkIHRvIGVycm9yIGhhbmRsZXJcbmFwcC51c2UoZnVuY3Rpb24ocmVxLCByZXMsIG5leHQpIHtcbiAgbmV4dChjcmVhdGVFcnJvcig0MDQpKTtcbn0pO1xuXG4vLyBlcnJvciBoYW5kbGVyXG5hcHAudXNlKGZ1bmN0aW9uKGVyciwgcmVxLCByZXMsIG5leHQpIHtcbiAgLy8gc2V0IGxvY2Fscywgb25seSBwcm92aWRpbmcgZXJyb3IgaW4gZGV2ZWxvcG1lbnRcbiAgcmVzLmxvY2Fscy5tZXNzYWdlID0gZXJyLm1lc3NhZ2U7XG4gIHJlcy5sb2NhbHMuZXJyb3IgPSByZXEuYXBwLmdldCgnZW52JykgPT09ICdkZXZlbG9wbWVudCcgPyBlcnIgOiB7fTtcblxuICAvLyByZW5kZXIgdGhlIGVycm9yIHBhZ2VcbiAgcmVzLnN0YXR1cyhlcnIuc3RhdHVzIHx8IDUwMCk7XG4gIHJlcy5yZW5kZXIoJ2Vycm9yJyk7XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBhcHA7XG5cbmNvbnN0IHtNb25nb0NsaWVudH0gPSByZXF1aXJlKCdtb25nb2RiJyk7XG5sZXQgdXJsID0gXCJtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3L1wiO1xuXG5cbi8qTW9uZ29DbGllbnQuY29ubmVjdCh1cmwsIChlcnIsIGRiKSA9PiB7XG4gICAgaWYoZXJyKSB7IHRocm93IGVycjsgfVxuICAgIGxldCBkYm8gPSBkYi5kYihcInRkcDAxM1wiKTtcbiAgICBkYm8uY29sbGVjdGlvbihcIm1vdmllXCIpLmZpbmQoe30pLnRvQXJyYXkoKGVyciwgcmVzdWx0KSA9PiB7XG4gICAgICBpZihlcnIpeyB0aHJvdyBlcnI7IH1cbiAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgfSk7XG4gICAgLy8gY2xvc2UgY29ubmVjdGlvbiB3aGVuIGRvbmUgd2l0aCBtb25nb1xuICAgIGRiLmNsb3NlKClcbiB9KTsgKi9cblxubGV0IHNlcnZlciA9IGFwcC5saXN0ZW4oODg4OCwgKCkgPT4ge1xuICBsZXQgaG9zdCA9IHNlcnZlci5hZGRyZXNzKCkuYWRkcmVzc1xuICBsZXQgcG9ydCA9IHNlcnZlci5hZGRyZXNzKCkucG9ydFxuICBjb25zb2xlLmxvZyhgTHlzc25hciBww6UgaHR0cDovLyR7aG9zdH06JHtwb3J0fWApXG4gfSkiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "app.js"
      ],
      "names": [
        "createError",
        "require",
        "express",
        "path",
        "cookieParser",
        "logger",
        "indexRouter",
        "usersRouter",
        "app",
        "set",
        "join",
        "__dirname",
        "use",
        "json",
        "urlencoded",
        "extended",
        "static",
        "req",
        "res",
        "next",
        "err",
        "locals",
        "message",
        "error",
        "get",
        "status",
        "render",
        "module",
        "exports",
        "MongoClient",
        "url",
        "server",
        "listen",
        "host",
        "address",
        "port",
        "console",
        "log"
      ],
      "mappings": "AAAA,IAAIA,WAAW,GAAGC,OAAO,CAAC,aAAD,CAAzB;;AACA,IAAIC,OAAO,GAAGD,OAAO,CAAC,SAAD,CAArB;;AACA,IAAIE,IAAI,GAAGF,OAAO,CAAC,MAAD,CAAlB;;AACA,IAAIG,YAAY,GAAGH,OAAO,CAAC,eAAD,CAA1B;;AACA,IAAII,MAAM,GAAGJ,OAAO,CAAC,QAAD,CAApB;;AAEA,IAAIK,WAAW,GAAGL,OAAO,CAAC,gBAAD,CAAzB;;AACA,IAAIM,WAAW,GAAGN,OAAO,CAAC,gBAAD,CAAzB;;AAEA,IAAIO,GAAG,GAAGN,OAAO,EAAjB,C,CAEA;;AACAM,GAAG,CAACC,GAAJ,CAAQ,OAAR,EAAiBN,IAAI,CAACO,IAAL,CAAUC,SAAV,EAAqB,OAArB,CAAjB;AACAH,GAAG,CAACC,GAAJ,CAAQ,aAAR,EAAuB,MAAvB;AAEAD,GAAG,CAACI,GAAJ,CAAQP,MAAM,CAAC,KAAD,CAAd;AACAG,GAAG,CAACI,GAAJ,CAAQV,OAAO,CAACW,IAAR,EAAR;AACAL,GAAG,CAACI,GAAJ,CAAQV,OAAO,CAACY,UAAR,CAAmB;AAAEC,EAAAA,QAAQ,EAAE;AAAZ,CAAnB,CAAR;AACAP,GAAG,CAACI,GAAJ,CAAQR,YAAY,EAApB;AACAI,GAAG,CAACI,GAAJ,CAAQV,OAAO,CAACc,MAAR,CAAeb,IAAI,CAACO,IAAL,CAAUC,SAAV,EAAqB,QAArB,CAAf,CAAR;AAEAH,GAAG,CAACI,GAAJ,CAAQ,GAAR,EAAaN,WAAb;AACAE,GAAG,CAACI,GAAJ,CAAQ,QAAR,EAAkBL,WAAlB,E,CAGA;;AACAC,GAAG,CAACI,GAAJ,CAAQ,UAASK,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC/BA,EAAAA,IAAI,CAACnB,WAAW,CAAC,GAAD,CAAZ,CAAJ;AACD,CAFD,E,CAIA;;AACAQ,GAAG,CAACI,GAAJ,CAAQ,UAASQ,GAAT,EAAcH,GAAd,EAAmBC,GAAnB,EAAwBC,IAAxB,EAA8B;AACpC;AACAD,EAAAA,GAAG,CAACG,MAAJ,CAAWC,OAAX,GAAqBF,GAAG,CAACE,OAAzB;AACAJ,EAAAA,GAAG,CAACG,MAAJ,CAAWE,KAAX,GAAmBN,GAAG,CAACT,GAAJ,CAAQgB,GAAR,CAAY,KAAZ,MAAuB,aAAvB,GAAuCJ,GAAvC,GAA6C,EAAhE,CAHoC,CAKpC;;AACAF,EAAAA,GAAG,CAACO,MAAJ,CAAWL,GAAG,CAACK,MAAJ,IAAc,GAAzB;AACAP,EAAAA,GAAG,CAACQ,MAAJ,CAAW,OAAX;AACD,CARD;AAUAC,MAAM,CAACC,OAAP,GAAiBpB,GAAjB;;AAEA,MAAM;AAACqB,EAAAA;AAAD,IAAgB5B,OAAO,CAAC,SAAD,CAA7B;;AACA,IAAI6B,GAAG,GAAG,4BAAV;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIC,MAAM,GAAGvB,GAAG,CAACwB,MAAJ,CAAW,IAAX,EAAiB,MAAM;AAClC,MAAIC,IAAI,GAAGF,MAAM,CAACG,OAAP,GAAiBA,OAA5B;AACA,MAAIC,IAAI,GAAGJ,MAAM,CAACG,OAAP,GAAiBC,IAA5B;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAa,qBAAoBJ,IAAK,IAAGE,IAAK,EAA9C;AACA,CAJW,CAAb",
      "sourceRoot": "/home/vinah331/Desktop/tdp013/lab2/",
      "sourcesContent": [
        "var createError = require('http-errors');\nvar express = require('express');\nvar path = require('path');\nvar cookieParser = require('cookie-parser');\nvar logger = require('morgan');\n\nvar indexRouter = require('./routes/index');\nvar usersRouter = require('./routes/users');\n\nvar app = express();\n\n// view engine setup\napp.set('views', path.join(__dirname, 'views'));\napp.set('view engine', 'jade');\n\napp.use(logger('dev'));\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\napp.use(cookieParser());\napp.use(express.static(path.join(__dirname, 'public')));\n\napp.use('/', indexRouter);\napp.use('/users', usersRouter);\n\n\n// catch 404 and forward to error handler\napp.use(function(req, res, next) {\n  next(createError(404));\n});\n\n// error handler\napp.use(function(err, req, res, next) {\n  // set locals, only providing error in development\n  res.locals.message = err.message;\n  res.locals.error = req.app.get('env') === 'development' ? err : {};\n\n  // render the error page\n  res.status(err.status || 500);\n  res.render('error');\n});\n\nmodule.exports = app;\n\nconst {MongoClient} = require('mongodb');\nlet url = \"mongodb://localhost:27017/\";\n\n\n/*MongoClient.connect(url, (err, db) => {\n    if(err) { throw err; }\n    let dbo = db.db(\"tdp013\");\n    dbo.collection(\"movie\").find({}).toArray((err, result) => {\n      if(err){ throw err; }\n      console.log(result);\n    });\n    // close connection when done with mongo\n    db.close()\n }); */\n\nlet server = app.listen(8888, () => {\n  let host = server.address().address\n  let port = server.address().port\n  console.log(`Lyssnar på http://${host}:${port}`)\n })"
      ]
    },
    "sourceType": "module",
    "mtime": 1631711039616
  },
  "{\"assumptions\":{},\"sourceRoot\":\"/home/vinah331/Desktop/tdp013/lab2/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/vinah331/Desktop/tdp013/lab2\",\"filename\":\"/home/vinah331/Desktop/tdp013/lab2/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/vinah331/Desktop/tdp013/lab2\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.15.5": {
    "metadata": {},
    "options": {
      "assumptions": {},
      "sourceRoot": "/home/vinah331/Desktop/tdp013/lab2/routes/",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/home/vinah331/Desktop/tdp013/lab2",
      "filename": "/home/vinah331/Desktop/tdp013/lab2/routes/index.js",
      "targets": {},
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "browserslistConfigFile": false,
      "envName": "development",
      "root": "/home/vinah331/Desktop/tdp013/lab2",
      "rootMode": "root",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/home/vinah331/Desktop/tdp013/lab2/routes/index.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "/home/vinah331/Desktop/tdp013/lab2/routes/index.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/home/vinah331/Desktop/tdp013/lab2/routes/",
        "sourceFileName": "index.js"
      }
    },
    "ast": null,
    "code": "var express = require('express');\n\nconst app = express();\nvar router = express.Router();\n\nconst {\n  MongoClient\n} = require('mongodb');\n\nlet sanitize = require('mongo-sanitize');\n\nlet url = \"mongodb://localhost:27017/\";\napp.use(express.json());\napp.use(express.urlencoded({\n  extended: false\n}));\nrouter.all('/messages', function (req, res, next) {\n  if (req.method == \"POST\" || req.method == \"GET\") {\n    next();\n  } else {\n    res.sendStatus(405);\n  }\n});\nrouter.all('/messages/:id', function (req, res, next) {\n  if (req.method == \"PATCH\" || req.method == \"GET\") {\n    next();\n  } else {\n    res.sendStatus(405);\n  }\n}); //------------------------------------------------------------------\n//Save one\n\nrouter.post('/messages', (req, res) => {\n  if (validateMsg(req.body)) {\n    msg = sanitize(req.body);\n    const regex = new RegExp(/<script>/); //injection?\n\n    if (!regex.test(msg)) {\n      console.log(req.body);\n      MongoClient.connect(url, (err, db) => {\n        let dbo = db.db(\"tdp013\");\n        dbo.collection('messages').insertOne(msg, function (err, res) {\n          if (err) {\n            console.log(err);\n          } else {\n            console.log('item inserted');\n          }\n\n          db.close();\n        });\n      });\n      res.sendStatus(200);\n    } else {\n      res.sendStatus(500);\n    }\n  } else {\n    res.sendStatus(500);\n  }\n});\n\nfunction validateMsg(msg) {\n  if (msg.length == 0 || msg.length > 140) {\n    return false;\n  }\n\n  return true;\n} //------------------------------------------------------------------\n//Mark read\n\n\nrouter.patch('/messages/:id', (req, res) => {\n  let msgId = sanitize(req.params.id);\n  console.log(\"in patch function with value \" + msgId);\n  const regex = new RegExp(/\\D+/);\n\n  if (regex.test(msgId)) {\n    res.sendStatus(400);\n  } else {\n    MongoClient.connect(url, (err, db) => {\n      let dbo = db.db(\"tdp013\");\n      let myquery = {\n        id: msgId\n      };\n      dbo.collection(\"messages\").findOne(myquery, function (err, result) {\n        if (err) {\n          console.log(err);\n        } else {\n          //console.log(\"Result = \" + result.id + \" \" + result.state + \" \" + result.msg)\n          let newvalues = {\n            $set: {\n              state: !result.state\n            }\n          };\n          dbo.collection(\"messages\").updateOne(myquery, newvalues, function (err, res) {\n            if (err) {\n              console.log(err);\n            } else {\n              console.log(\"1 document updated\");\n            }\n\n            db.close();\n          });\n        }\n      });\n    });\n    res.sendStatus(200);\n  }\n}); //------------------------------------------------------------------\n//Get all\n\nrouter.get('/messages', (req, res) => {\n  MongoClient.connect(url, (err, db) => {\n    let dbo = db.db(\"tdp013\");\n    dbo.collection('messages').find({}).toArray(function (err, result) {\n      if (err) {\n        console.log(err);\n      }\n\n      db.close();\n      res.sendStatus(200);\n    });\n  }); //res.send()\n}); //------------------------------------------------------------------\n// Get one\n\nrouter.get('/messages/:id', (req, res) => {\n  let msgId = sanitize(req.params.id);\n  const regex = new RegExp(/\\D+/);\n\n  if (regex.test(msgId)) {\n    res.sendStatus(400);\n  } else {\n    MongoClient.connect(url, (err, db) => {\n      let dbo = db.db(\"tdp013\");\n      let myquery = {\n        id: msgId\n      };\n      dbo.collection(\"messages\").findOne(myquery, function (err, result) {\n        if (err) {\n          console.log(err);\n        }\n\n        db.close();\n        res.sendStatus(200);\n      });\n    });\n  }\n});\nrouter.all('*', function (req, res, next) {\n  //If no function exists\n  res.sendStatus(404);\n}); // error handler middleware\n\napp.use((error, req, res, next) => {\n  console.error(error.stack);\n  res.status(500).send('Something Broke!');\n});\nmodule.exports = router;\n/*använd asynkrona anrop för att hämta och lagra data. \nKan ta in en resolve och reject funktion. \nMed detta kan vi skicka rätt felmeddelanden.\nen backend fil som hanterar logik\nen testfil som representerar klient-logiken \n(alltså om vi klickar på en knapp kommer meddelande x\nskickas t.ex)*/\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwiYXBwIiwicm91dGVyIiwiUm91dGVyIiwiTW9uZ29DbGllbnQiLCJzYW5pdGl6ZSIsInVybCIsInVzZSIsImpzb24iLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJhbGwiLCJyZXEiLCJyZXMiLCJuZXh0IiwibWV0aG9kIiwic2VuZFN0YXR1cyIsInBvc3QiLCJ2YWxpZGF0ZU1zZyIsImJvZHkiLCJtc2ciLCJyZWdleCIsIlJlZ0V4cCIsInRlc3QiLCJjb25zb2xlIiwibG9nIiwiY29ubmVjdCIsImVyciIsImRiIiwiZGJvIiwiY29sbGVjdGlvbiIsImluc2VydE9uZSIsImNsb3NlIiwibGVuZ3RoIiwicGF0Y2giLCJtc2dJZCIsInBhcmFtcyIsImlkIiwibXlxdWVyeSIsImZpbmRPbmUiLCJyZXN1bHQiLCJuZXd2YWx1ZXMiLCIkc2V0Iiwic3RhdGUiLCJ1cGRhdGVPbmUiLCJnZXQiLCJmaW5kIiwidG9BcnJheSIsImVycm9yIiwic3RhY2siLCJzdGF0dXMiLCJzZW5kIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBRCxDQUFyQjs7QUFDQSxNQUFNQyxHQUFHLEdBQUdGLE9BQU8sRUFBbkI7QUFDQSxJQUFJRyxNQUFNLEdBQUdILE9BQU8sQ0FBQ0ksTUFBUixFQUFiOztBQUNBLE1BQU07QUFBQ0MsRUFBQUE7QUFBRCxJQUFnQkosT0FBTyxDQUFDLFNBQUQsQ0FBN0I7O0FBQ0EsSUFBSUssUUFBUSxHQUFHTCxPQUFPLENBQUMsZ0JBQUQsQ0FBdEI7O0FBQ0EsSUFBSU0sR0FBRyxHQUFHLDRCQUFWO0FBRUFMLEdBQUcsQ0FBQ00sR0FBSixDQUFRUixPQUFPLENBQUNTLElBQVIsRUFBUjtBQUNBUCxHQUFHLENBQUNNLEdBQUosQ0FBUVIsT0FBTyxDQUFDVSxVQUFSLENBQW1CO0FBQUVDLEVBQUFBLFFBQVEsRUFB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cmNlc0NvbnRlbnQiOlsidmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCBhcHAgPSBleHByZXNzKCk7XG52YXIgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcbmNvbnN0IHtNb25nb0NsaWVudH0gPSByZXF1aXJlKCdtb25nb2RiJyk7XG5sZXQgc2FuaXRpemUgPSByZXF1aXJlKCdtb25nby1zYW5pdGl6ZScpO1xubGV0IHVybCA9IFwibW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNy9cIjtcblxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XG5hcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiBmYWxzZSB9KSk7XG5cblxucm91dGVyLmFsbCgnL21lc3NhZ2VzJywgZnVuY3Rpb24ocmVxLCByZXMsIG5leHQpIHtcbiAgaWYocmVxLm1ldGhvZCA9PSBcIlBPU1RcIiB8fCByZXEubWV0aG9kID09IFwiR0VUXCIpIHtcbiAgICBuZXh0KCk7XG4gIH0gZWxzZSB7XG4gICAgcmVzLnNlbmRTdGF0dXMoNDA1KVxuICB9XG59KVxuXG5yb3V0ZXIuYWxsKCcvbWVzc2FnZXMvOmlkJywgZnVuY3Rpb24ocmVxLCByZXMsIG5leHQpIHtcbiAgaWYocmVxLm1ldGhvZCA9PSBcIlBBVENIXCIgfHwgcmVxLm1ldGhvZCA9PSBcIkdFVFwiKSB7XG4gICAgbmV4dCgpO1xuICB9IGVsc2Uge1xuICAgIHJlcy5zZW5kU3RhdHVzKDQwNSlcbiAgfVxufSlcblxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9TYXZlIG9uZVxuXG5yb3V0ZXIucG9zdCgnL21lc3NhZ2VzJywgKHJlcSwgcmVzKSA9PiB7XG4gIGlmICh2YWxpZGF0ZU1zZyhyZXEuYm9keSkpIHtcbiAgICBtc2cgPSBzYW5pdGl6ZShyZXEuYm9keSlcbiAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoLzxzY3JpcHQ+LykgIC8vaW5qZWN0aW9uP1xuICAgIGlmICghcmVnZXgudGVzdChtc2cpKSB7XG4gICAgICBjb25zb2xlLmxvZyhyZXEuYm9keSlcbiAgICAgIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsLCAoZXJyLCBkYikgPT4ge1xuICAgICAgICBsZXQgZGJvID0gZGIuZGIoXCJ0ZHAwMTNcIik7XG4gICAgICAgIGRiby5jb2xsZWN0aW9uKCdtZXNzYWdlcycpLmluc2VydE9uZShtc2csIGZ1bmN0aW9uKGVyciwgcmVzKSB7XG4gICAgICAgICAgaWYgKGVycikge2NvbnNvbGUubG9nKGVycil9XG4gICAgICAgICAgZWxzZSB7Y29uc29sZS5sb2coJ2l0ZW0gaW5zZXJ0ZWQnKX1cbiAgICAgICAgICBkYi5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgcmVzLnNlbmRTdGF0dXMoMjAwKVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHJlcy5zZW5kU3RhdHVzKDUwMClcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmVzLnNlbmRTdGF0dXMoNTAwKVxuICB9XG4gIFxufSlcblxuZnVuY3Rpb24gdmFsaWRhdGVNc2cobXNnKSB7XG4gIGlmIChtc2cubGVuZ3RoID09IDAgfHwgbXNnLmxlbmd0aCA+IDE0MCkge1xuICAgIHJldHVybiBmYWxzZVxuICB9IFxuICByZXR1cm4gdHJ1ZVxufVxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9NYXJrIHJlYWRcbnJvdXRlci5wYXRjaCgoJy9tZXNzYWdlcy86aWQnKSwgKHJlcSwgcmVzKSA9PiB7XG4gIGxldCBtc2dJZCA9IHNhbml0aXplKHJlcS5wYXJhbXMuaWQpXG4gIGNvbnNvbGUubG9nKFwiaW4gcGF0Y2ggZnVuY3Rpb24gd2l0aCB2YWx1ZSBcIiArIG1zZ0lkKVxuXG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cCgvXFxEKy8pXG5cbiAgaWYgKHJlZ2V4LnRlc3QobXNnSWQpKSB7XG4gICAgcmVzLnNlbmRTdGF0dXMoNDAwKVxuICB9IGVsc2Uge1xuICAgIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsLCAoZXJyLCBkYikgPT4ge1xuICAgICAgbGV0IGRibyA9IGRiLmRiKFwidGRwMDEzXCIpO1xuICAgICAgbGV0IG15cXVlcnkgPSB7IGlkOiBtc2dJZCB9O1xuXG4gICAgICBkYm8uY29sbGVjdGlvbihcIm1lc3NhZ2VzXCIpLmZpbmRPbmUobXlxdWVyeSwgZnVuY3Rpb24oZXJyLCByZXN1bHQpIHtcbiAgICAgICAgaWYgKGVycikge2NvbnNvbGUubG9nKGVycil9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIC8vY29uc29sZS5sb2coXCJSZXN1bHQgPSBcIiArIHJlc3VsdC5pZCArIFwiIFwiICsgcmVzdWx0LnN0YXRlICsgXCIgXCIgKyByZXN1bHQubXNnKVxuICAgICAgICAgIGxldCBuZXd2YWx1ZXMgPSB7ICRzZXQ6IHtzdGF0ZTogIShyZXN1bHQuc3RhdGUpfSB9O1xuICAgICAgICAgIFxuICAgICAgICAgIGRiby5jb2xsZWN0aW9uKFwibWVzc2FnZXNcIikudXBkYXRlT25lKG15cXVlcnksIG5ld3ZhbHVlcywgZnVuY3Rpb24oZXJyLCByZXMpIHtcbiAgICAgICAgICAgIGlmIChlcnIpIHtjb25zb2xlLmxvZyhlcnIpfVxuICAgICAgICAgICAgZWxzZSB7Y29uc29sZS5sb2coXCIxIGRvY3VtZW50IHVwZGF0ZWRcIik7fVxuICAgICAgICAgICAgZGIuY2xvc2UoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmVzLnNlbmRTdGF0dXMoMjAwKVxuICB9XG59KVxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9HZXQgYWxsXG5yb3V0ZXIuZ2V0KCgnL21lc3NhZ2VzJyksIChyZXEsIHJlcykgPT4ge1xuXG4gIE1vbmdvQ2xpZW50LmNvbm5lY3QodXJsLCAoZXJyLCBkYikgPT4ge1xuICAgIGxldCBkYm8gPSBkYi5kYihcInRkcDAxM1wiKTtcblxuICAgIGRiby5jb2xsZWN0aW9uKCdtZXNzYWdlcycpLmZpbmQoe30pLnRvQXJyYXkoZnVuY3Rpb24oZXJyLCByZXN1bHQpIHtcbiAgICAgIGlmIChlcnIpIHtjb25zb2xlLmxvZyhlcnIpfVxuICAgICAgZGIuY2xvc2UoKTtcbiAgICAgIHJlcy5zZW5kU3RhdHVzKDIwMClcbiAgICB9KVxuICAgIFxuICB9KVxuICAvL3Jlcy5zZW5kKClcbn0pXG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBHZXQgb25lXG5yb3V0ZXIuZ2V0KCgnL21lc3NhZ2VzLzppZCcpLCAocmVxLCByZXMpID0+IHtcbiAgbGV0IG1zZ0lkID0gc2FuaXRpemUocmVxLnBhcmFtcy5pZClcbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKC9cXEQrLylcbiAgaWYgKHJlZ2V4LnRlc3QobXNnSWQpKSB7XG4gICAgcmVzLnNlbmRTdGF0dXMoNDAwKVxuICB9IGVsc2Uge1xuXG4gICAgTW9uZ29DbGllbnQuY29ubmVjdCh1cmwsIChlcnIsIGRiKSA9PiB7XG4gICAgICBsZXQgZGJvID0gZGIuZGIoXCJ0ZHAwMTNcIik7XG4gICAgICBsZXQgbXlxdWVyeSA9IHsgaWQ6IG1zZ0lkIH07XG5cbiAgICAgIGRiby5jb2xsZWN0aW9uKFwibWVzc2FnZXNcIikuZmluZE9uZShteXF1ZXJ5LCBmdW5jdGlvbihlcnIsIHJlc3VsdCkge1xuICAgICAgICBpZiAoZXJyKSB7Y29uc29sZS5sb2coZXJyKX1cbiAgICAgICAgZGIuY2xvc2UoKTtcbiAgICAgICAgcmVzLnNlbmRTdGF0dXMoMjAwKVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn0pXG5cblxucm91dGVyLmFsbCgnKicsIGZ1bmN0aW9uKHJlcSwgcmVzLCBuZXh0KSB7XG4gIC8vSWYgbm8gZnVuY3Rpb24gZXhpc3RzXG4gIHJlcy5zZW5kU3RhdHVzKDQwNClcbn0pXG5cbi8vIGVycm9yIGhhbmRsZXIgbWlkZGxld2FyZVxuYXBwLnVzZSgoZXJyb3IsIHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnNvbGUuZXJyb3IoZXJyb3Iuc3RhY2spO1xuICByZXMuc3RhdHVzKDUwMCkuc2VuZCgnU29tZXRoaW5nIEJyb2tlIScpO1xuIH0pXG5cbm1vZHVsZS5leHBvcnRzID0gcm91dGVyO1xuXG5cbi8qYW52w6RuZCBhc3lua3JvbmEgYW5yb3AgZsO2ciBhdHQgaMOkbXRhIG9jaCBsYWdyYSBkYXRhLiBcbkthbiB0YSBpbiBlbiByZXNvbHZlIG9jaCByZWplY3QgZnVua3Rpb24uIFxuTWVkIGRldHRhIGthbiB2aSBza2lja2EgcsOkdHQgZmVsbWVkZGVsYW5kZW4uXG5lbiBiYWNrZW5kIGZpbCBzb20gaGFudGVyYXIgbG9naWtcbmVuIHRlc3RmaWwgc29tIHJlcHJlc2VudGVyYXIga2xpZW50LWxvZ2lrZW4gXG4oYWxsdHPDpSBvbSB2aSBrbGlja2FyIHDDpSBlbiBrbmFwcCBrb21tZXIgbWVkZGVsYW5kZSB4XG5za2lja2FzIHQuZXgpKi9cbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "index.js"
      ],
      "names": [
        "express",
        "require",
        "app",
        "router",
        "Router",
        "MongoClient",
        "sanitize",
        "url",
        "use",
        "json",
        "urlencoded",
        "extended",
        "all",
        "req",
        "res",
        "next",
        "method",
        "sendStatus",
        "post",
        "validateMsg",
        "body",
        "msg",
        "regex",
        "RegExp",
        "test",
        "console",
        "log",
        "connect",
        "err",
        "db",
        "dbo",
        "collection",
        "insertOne",
        "close",
        "length",
        "patch",
        "msgId",
        "params",
        "id",
        "myquery",
        "findOne",
        "result",
        "newvalues",
        "$set",
        "state",
        "updateOne",
        "get",
        "find",
        "toArray",
        "error",
        "stack",
        "status",
        "send",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "/home/vinah331/Desktop/tdp013/lab2/routes/",
      "sourcesContent": [
        "var express = require('express');\nconst app = express();\nvar router = express.Router();\nconst {MongoClient} = require('mongodb');\nlet sanitize = require('mongo-sanitize');\nlet url = \"mongodb://localhost:27017/\";\n\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\n\nrouter.all('/messages', function(req, res, next) {\n  if(req.method == \"POST\" || req.method == \"GET\") {\n    next();\n  } else {\n    res.sendStatus(405)\n  }\n})\n\nrouter.all('/messages/:id', function(req, res, next) {\n  if(req.method == \"PATCH\" || req.method == \"GET\") {\n    next();\n  } else {\n    res.sendStatus(405)\n  }\n})\n\n\n//------------------------------------------------------------------\n//Save one\n\nrouter.post('/messages', (req, res) => {\n  if (validateMsg(req.body)) {\n    msg = sanitize(req.body)\n    const regex = new RegExp(/<script>/)  //injection?\n    if (!regex.test(msg)) {\n      console.log(req.body)\n      MongoClient.connect(url, (err, db) => {\n        let dbo = db.db(\"tdp013\");\n        dbo.collection('messages').insertOne(msg, function(err, res) {\n          if (err) {console.log(err)}\n          else {console.log('item inserted')}\n          db.close();\n        });\n      });\n      res.sendStatus(200)\n    }\n    else {\n      res.sendStatus(500)\n    }\n  } else {\n    res.sendStatus(500)\n  }\n  \n})\n\nfunction validateMsg(msg) {\n  if (msg.length == 0 || msg.length > 140) {\n    return false\n  } \n  return true\n}\n\n//------------------------------------------------------------------\n//Mark read\nrouter.patch(('/messages/:id'), (req, res) => {\n  let msgId = sanitize(req.params.id)\n  console.log(\"in patch function with value \" + msgId)\n\n  const regex = new RegExp(/\\D+/)\n\n  if (regex.test(msgId)) {\n    res.sendStatus(400)\n  } else {\n    MongoClient.connect(url, (err, db) => {\n      let dbo = db.db(\"tdp013\");\n      let myquery = { id: msgId };\n\n      dbo.collection(\"messages\").findOne(myquery, function(err, result) {\n        if (err) {console.log(err)}\n        else {\n          //console.log(\"Result = \" + result.id + \" \" + result.state + \" \" + result.msg)\n          let newvalues = { $set: {state: !(result.state)} };\n          \n          dbo.collection(\"messages\").updateOne(myquery, newvalues, function(err, res) {\n            if (err) {console.log(err)}\n            else {console.log(\"1 document updated\");}\n            db.close();\n          });\n        }\n      });\n    });\n    res.sendStatus(200)\n  }\n})\n\n//------------------------------------------------------------------\n//Get all\nrouter.get(('/messages'), (req, res) => {\n\n  MongoClient.connect(url, (err, db) => {\n    let dbo = db.db(\"tdp013\");\n\n    dbo.collection('messages').find({}).toArray(function(err, result) {\n      if (err) {console.log(err)}\n      db.close();\n      res.sendStatus(200)\n    })\n    \n  })\n  //res.send()\n})\n\n//------------------------------------------------------------------\n// Get one\nrouter.get(('/messages/:id'), (req, res) => {\n  let msgId = sanitize(req.params.id)\n  const regex = new RegExp(/\\D+/)\n  if (regex.test(msgId)) {\n    res.sendStatus(400)\n  } else {\n\n    MongoClient.connect(url, (err, db) => {\n      let dbo = db.db(\"tdp013\");\n      let myquery = { id: msgId };\n\n      dbo.collection(\"messages\").findOne(myquery, function(err, result) {\n        if (err) {console.log(err)}\n        db.close();\n        res.sendStatus(200)\n      });\n    });\n  }\n})\n\n\nrouter.all('*', function(req, res, next) {\n  //If no function exists\n  res.sendStatus(404)\n})\n\n// error handler middleware\napp.use((error, req, res, next) => {\n  console.error(error.stack);\n  res.status(500).send('Something Broke!');\n })\n\nmodule.exports = router;\n\n\n/*använd asynkrona anrop för att hämta och lagra data. \nKan ta in en resolve och reject funktion. \nMed detta kan vi skicka rätt felmeddelanden.\nen backend fil som hanterar logik\nen testfil som representerar klient-logiken \n(alltså om vi klickar på en knapp kommer meddelande x\nskickas t.ex)*/\n"
      ]
    },
    "sourceType": "module",
    "mtime": 1631791076795
  },
  "{\"assumptions\":{},\"sourceRoot\":\"/home/vinah331/Desktop/tdp013/lab2/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/vinah331/Desktop/tdp013/lab2\",\"filename\":\"/home/vinah331/Desktop/tdp013/lab2/routes/users.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/vinah331/Desktop/tdp013/lab2\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.15.5": {
    "metadata": {},
    "options": {
      "assumptions": {},
      "sourceRoot": "/home/vinah331/Desktop/tdp013/lab2/routes/",
      "caller": {
        "name": "@babel/node"
      },
      "cwd": "/home/vinah331/Desktop/tdp013/lab2",
      "filename": "/home/vinah331/Desktop/tdp013/lab2/routes/users.js",
      "targets": {},
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "browserslistConfigFile": false,
      "envName": "development",
      "root": "/home/vinah331/Desktop/tdp013/lab2",
      "rootMode": "root",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "/home/vinah331/Desktop/tdp013/lab2/routes/users.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "/home/vinah331/Desktop/tdp013/lab2/routes/users.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "/home/vinah331/Desktop/tdp013/lab2/routes/",
        "sourceFileName": "users.js"
      }
    },
    "ast": null,
    "code": "var express = require('express');\n\nvar router = express.Router();\n/* GET users listing. */\n\nrouter.get('/', function (req, res, next) {\n  res.send('respond with a resource');\n});\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXJzLmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwicm91dGVyIiwiUm91dGVyIiwiZ2V0IiwicmVxIiwicmVzIiwibmV4dCIsInNlbmQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFELENBQXJCOztBQUNBLElBQUlDLE1BQU0sR0FBR0YsT0FBTyxDQUFDRyxNQUFSLEVBQWI7QUFFQTs7QUFDQUQsTUFBTSxDQUFDRSxHQUFQLENBQVcsR0FBWCxFQUFnQixVQUFTQyxHQUFULEVBQWNDLEdBQWQsRUFBbUJDLElBQW5CLEVBQXlCO0FBQ3ZDRCxFQUFBQSxHQUFHLENBQUNFLElBQUosQ0FBUyx5QkFBVDtBQUNELENBRkQ7QUFJQUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCUixNQUFqQiIsInNvdXJjZVJvb3QiOiIvaG9tZS92aW5haDMzMS9EZXNrdG9wL3RkcDAxMy9sYWIyL3JvdXRlcy8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbnZhciByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuXG4vKiBHRVQgdXNlcnMgbGlzdGluZy4gKi9cbnJvdXRlci5nZXQoJy8nLCBmdW5jdGlvbihyZXEsIHJlcywgbmV4dCkge1xuICByZXMuc2VuZCgncmVzcG9uZCB3aXRoIGEgcmVzb3VyY2UnKTtcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcbiJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "users.js"
      ],
      "names": [
        "express",
        "require",
        "router",
        "Router",
        "get",
        "req",
        "res",
        "next",
        "send",
        "module",
        "exports"
      ],
      "mappings": "AAAA,IAAIA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAArB;;AACA,IAAIC,MAAM,GAAGF,OAAO,CAACG,MAAR,EAAb;AAEA;;AACAD,MAAM,CAACE,GAAP,CAAW,GAAX,EAAgB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACvCD,EAAAA,GAAG,CAACE,IAAJ,CAAS,yBAAT;AACD,CAFD;AAIAC,MAAM,CAACC,OAAP,GAAiBR,MAAjB",
      "sourceRoot": "/home/vinah331/Desktop/tdp013/lab2/routes/",
      "sourcesContent": [
        "var express = require('express');\nvar router = express.Router();\n\n/* GET users listing. */\nrouter.get('/', function(req, res, next) {\n  res.send('respond with a resource');\n});\n\nmodule.exports = router;\n"
      ]
    },
    "sourceType": "module",
    "mtime": 1631534435311
  }
}