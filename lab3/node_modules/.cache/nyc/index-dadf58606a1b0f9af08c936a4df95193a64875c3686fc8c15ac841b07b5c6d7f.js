function cov_1cfddh0017(){var path="/home/vinah331/Desktop/tdp013/lab2/routes/index.js";var hash="1b6ac44bacba3be685a4741cdfa0626b4533e37f";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/vinah331/Desktop/tdp013/lab2/routes/index.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:32}},"1":{start:{line:2,column:12},end:{line:2,column:21}},"2":{start:{line:3,column:13},end:{line:3,column:29}},"3":{start:{line:4,column:22},end:{line:4,column:40}},"4":{start:{line:5,column:15},end:{line:5,column:40}},"5":{start:{line:6,column:10},end:{line:6,column:38}},"6":{start:{line:8,column:0},end:{line:8,column:24}},"7":{start:{line:9,column:0},end:{line:9,column:49}},"8":{start:{line:12,column:0},end:{line:23,column:2}},"9":{start:{line:13,column:2},end:{line:22,column:3}},"10":{start:{line:15,column:4},end:{line:17,column:5}},"11":{start:{line:16,column:8},end:{line:16,column:27}},"12":{start:{line:18,column:4},end:{line:18,column:11}},"13":{start:{line:21,column:4},end:{line:21,column:23}},"14":{start:{line:25,column:0},end:{line:32,column:2}},"15":{start:{line:27,column:2},end:{line:31,column:3}},"16":{start:{line:28,column:4},end:{line:28,column:11}},"17":{start:{line:30,column:4},end:{line:30,column:23}},"18":{start:{line:38,column:0},end:{line:63,column:2}},"19":{start:{line:39,column:2},end:{line:61,column:3}},"20":{start:{line:40,column:4},end:{line:40,column:28}},"21":{start:{line:41,column:18},end:{line:41,column:40}},"22":{start:{line:42,column:4},end:{line:58,column:5}},"23":{start:{line:44,column:6},end:{line:54,column:9}},"24":{start:{line:45,column:18},end:{line:45,column:33}},"25":{start:{line:46,column:8},end:{line:53,column:11}},"26":{start:{line:47,column:10},end:{line:51,column:11}},"27":{start:{line:49,column:12},end:{line:49,column:23}},"28":{start:{line:50,column:12},end:{line:50,column:31}},"29":{start:{line:57,column:6},end:{line:57,column:25}},"30":{start:{line:60,column:4},end:{line:60,column:23}},"31":{start:{line:67,column:2},end:{line:67,column:70}},"32":{start:{line:67,column:56},end:{line:67,column:68}},"33":{start:{line:68,column:2},end:{line:68,column:77}},"34":{start:{line:68,column:63},end:{line:68,column:75}},"35":{start:{line:69,column:2},end:{line:69,column:72}},"36":{start:{line:69,column:58},end:{line:69,column:70}},"37":{start:{line:70,column:2},end:{line:70,column:13}},"38":{start:{line:75,column:0},end:{line:117,column:2}},"39":{start:{line:77,column:14},end:{line:77,column:37}},"40":{start:{line:79,column:16},end:{line:79,column:33}},"41":{start:{line:81,column:2},end:{line:116,column:3}},"42":{start:{line:82,column:4},end:{line:82,column:23}},"43":{start:{line:85,column:4},end:{line:115,column:7}},"44":{start:{line:86,column:16},end:{line:86,column:31}},"45":{start:{line:87,column:20},end:{line:87,column:33}},"46":{start:{line:89,column:6},end:{line:113,column:9}},"47":{start:{line:90,column:8},end:{line:112,column:9}},"48":{start:{line:91,column:10},end:{line:91,column:29}},"49":{start:{line:93,column:13},end:{line:112,column:9}},"50":{start:{line:95,column:26},end:{line:95,column:60}},"51":{start:{line:97,column:10},end:{line:106,column:13}},"52":{start:{line:98,column:12},end:{line:105,column:13}},"53":{start:{line:99,column:14},end:{line:99,column:25}},"54":{start:{line:100,column:14},end:{line:100,column:33}},"55":{start:{line:103,column:14},end:{line:103,column:25}},"56":{start:{line:104,column:14},end:{line:104,column:33}},"57":{start:{line:110,column:10},end:{line:110,column:29}},"58":{start:{line:111,column:10},end:{line:111,column:21}},"59":{start:{line:121,column:0},end:{line:142,column:2}},"60":{start:{line:123,column:2},end:{line:140,column:4}},"61":{start:{line:124,column:14},end:{line:124,column:29}},"62":{start:{line:126,column:4},end:{line:138,column:6}},"63":{start:{line:127,column:6},end:{line:127,column:17}},"64":{start:{line:128,column:6},end:{line:137,column:7}},"65":{start:{line:131,column:11},end:{line:137,column:7}},"66":{start:{line:133,column:8},end:{line:133,column:24}},"67":{start:{line:136,column:8},end:{line:136,column:27}},"68":{start:{line:146,column:0},end:{line:171,column:2}},"69":{start:{line:147,column:14},end:{line:147,column:37}},"70":{start:{line:148,column:16},end:{line:148,column:33}},"71":{start:{line:149,column:2},end:{line:170,column:3}},"72":{start:{line:150,column:4},end:{line:150,column:23}},"73":{start:{line:153,column:4},end:{line:169,column:7}},"74":{start:{line:154,column:16},end:{line:154,column:31}},"75":{start:{line:155,column:20},end:{line:155,column:33}},"76":{start:{line:157,column:6},end:{line:168,column:9}},"77":{start:{line:158,column:8},end:{line:158,column:19}},"78":{start:{line:159,column:8},end:{line:167,column:9}},"79":{start:{line:162,column:13},end:{line:167,column:9}},"80":{start:{line:163,column:10},end:{line:163,column:26}},"81":{start:{line:166,column:10},end:{line:166,column:29}},"82":{start:{line:173,column:0},end:{line:176,column:2}},"83":{start:{line:175,column:2},end:{line:175,column:41}},"84":{start:{line:179,column:0},end:{line:179,column:24}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:12,column:24},end:{line:12,column:25}},loc:{start:{line:12,column:49},end:{line:23,column:1}},line:12},"1":{name:"(anonymous_1)",decl:{start:{line:25,column:28},end:{line:25,column:29}},loc:{start:{line:25,column:53},end:{line:32,column:1}},line:25},"2":{name:"(anonymous_2)",decl:{start:{line:38,column:25},end:{line:38,column:26}},loc:{start:{line:38,column:39},end:{line:63,column:1}},line:38},"3":{name:"(anonymous_3)",decl:{start:{line:44,column:31},end:{line:44,column:32}},loc:{start:{line:44,column:44},end:{line:54,column:7}},line:44},"4":{name:"(anonymous_4)",decl:{start:{line:46,column:50},end:{line:46,column:51}},loc:{start:{line:46,column:72},end:{line:53,column:9}},line:46},"5":{name:"validateMsg",decl:{start:{line:65,column:9},end:{line:65,column:20}},loc:{start:{line:65,column:27},end:{line:71,column:1}},line:65},"6":{name:"(anonymous_6)",decl:{start:{line:75,column:32},end:{line:75,column:33}},loc:{start:{line:75,column:46},end:{line:117,column:1}},line:75},"7":{name:"(anonymous_7)",decl:{start:{line:85,column:29},end:{line:85,column:30}},loc:{start:{line:85,column:42},end:{line:115,column:5}},line:85},"8":{name:"(anonymous_8)",decl:{start:{line:89,column:50},end:{line:89,column:51}},loc:{start:{line:89,column:72},end:{line:113,column:7}},line:89},"9":{name:"(anonymous_9)",decl:{start:{line:97,column:67},end:{line:97,column:68}},loc:{start:{line:97,column:90},end:{line:106,column:11}},line:97},"10":{name:"(anonymous_10)",decl:{start:{line:121,column:26},end:{line:121,column:27}},loc:{start:{line:121,column:40},end:{line:142,column:1}},line:121},"11":{name:"(anonymous_11)",decl:{start:{line:123,column:27},end:{line:123,column:28}},loc:{start:{line:123,column:40},end:{line:140,column:3}},line:123},"12":{name:"(anonymous_12)",decl:{start:{line:126,column:48},end:{line:126,column:49}},loc:{start:{line:126,column:70},end:{line:138,column:5}},line:126},"13":{name:"(anonymous_13)",decl:{start:{line:146,column:30},end:{line:146,column:31}},loc:{start:{line:146,column:44},end:{line:171,column:1}},line:146},"14":{name:"(anonymous_14)",decl:{start:{line:153,column:29},end:{line:153,column:30}},loc:{start:{line:153,column:42},end:{line:169,column:5}},line:153},"15":{name:"(anonymous_15)",decl:{start:{line:157,column:50},end:{line:157,column:51}},loc:{start:{line:157,column:72},end:{line:168,column:7}},line:157},"16":{name:"(anonymous_16)",decl:{start:{line:173,column:8},end:{line:173,column:9}},loc:{start:{line:173,column:28},end:{line:176,column:1}},line:173}},branchMap:{"0":{loc:{start:{line:13,column:2},end:{line:22,column:3}},type:"if",locations:[{start:{line:13,column:2},end:{line:22,column:3}},{start:{line:13,column:2},end:{line:22,column:3}}],line:13},"1":{loc:{start:{line:13,column:5},end:{line:13,column:48}},type:"binary-expr",locations:[{start:{line:13,column:5},end:{line:13,column:25}},{start:{line:13,column:29},end:{line:13,column:48}}],line:13},"2":{loc:{start:{line:15,column:4},end:{line:17,column:5}},type:"if",locations:[{start:{line:15,column:4},end:{line:17,column:5}},{start:{line:15,column:4},end:{line:17,column:5}}],line:15},"3":{loc:{start:{line:15,column:8},end:{line:15,column:39}},type:"binary-expr",locations:[{start:{line:15,column:8},end:{line:15,column:27}},{start:{line:15,column:31},end:{line:15,column:39}}],line:15},"4":{loc:{start:{line:27,column:2},end:{line:31,column:3}},type:"if",locations:[{start:{line:27,column:2},end:{line:31,column:3}},{start:{line:27,column:2},end:{line:31,column:3}}],line:27},"5":{loc:{start:{line:27,column:5},end:{line:27,column:49}},type:"binary-expr",locations:[{start:{line:27,column:5},end:{line:27,column:26}},{start:{line:27,column:30},end:{line:27,column:49}}],line:27},"6":{loc:{start:{line:39,column:2},end:{line:61,column:3}},type:"if",locations:[{start:{line:39,column:2},end:{line:61,column:3}},{start:{line:39,column:2},end:{line:61,column:3}}],line:39},"7":{loc:{start:{line:42,column:4},end:{line:58,column:5}},type:"if",locations:[{start:{line:42,column:4},end:{line:58,column:5}},{start:{line:42,column:4},end:{line:58,column:5}}],line:42},"8":{loc:{start:{line:47,column:10},end:{line:51,column:11}},type:"if",locations:[{start:{line:47,column:10},end:{line:51,column:11}},{start:{line:47,column:10},end:{line:51,column:11}}],line:47},"9":{loc:{start:{line:67,column:2},end:{line:67,column:70}},type:"if",locations:[{start:{line:67,column:2},end:{line:67,column:70}},{start:{line:67,column:2},end:{line:67,column:70}}],line:67},"10":{loc:{start:{line:67,column:6},end:{line:67,column:52}},type:"binary-expr",locations:[{start:{line:67,column:6},end:{line:67,column:27}},{start:{line:67,column:31},end:{line:67,column:52}}],line:67},"11":{loc:{start:{line:68,column:2},end:{line:68,column:77}},type:"if",locations:[{start:{line:68,column:2},end:{line:68,column:77}},{start:{line:68,column:2},end:{line:68,column:77}}],line:68},"12":{loc:{start:{line:69,column:2},end:{line:69,column:72}},type:"if",locations:[{start:{line:69,column:2},end:{line:69,column:72}},{start:{line:69,column:2},end:{line:69,column:72}}],line:69},"13":{loc:{start:{line:81,column:2},end:{line:116,column:3}},type:"if",locations:[{start:{line:81,column:2},end:{line:116,column:3}},{start:{line:81,column:2},end:{line:116,column:3}}],line:81},"14":{loc:{start:{line:90,column:8},end:{line:112,column:9}},type:"if",locations:[{start:{line:90,column:8},end:{line:112,column:9}},{start:{line:90,column:8},end:{line:112,column:9}}],line:90},"15":{loc:{start:{line:93,column:13},end:{line:112,column:9}},type:"if",locations:[{start:{line:93,column:13},end:{line:112,column:9}},{start:{line:93,column:13},end:{line:112,column:9}}],line:93},"16":{loc:{start:{line:98,column:12},end:{line:105,column:13}},type:"if",locations:[{start:{line:98,column:12},end:{line:105,column:13}},{start:{line:98,column:12},end:{line:105,column:13}}],line:98},"17":{loc:{start:{line:128,column:6},end:{line:137,column:7}},type:"if",locations:[{start:{line:128,column:6},end:{line:137,column:7}},{start:{line:128,column:6},end:{line:137,column:7}}],line:128},"18":{loc:{start:{line:131,column:11},end:{line:137,column:7}},type:"if",locations:[{start:{line:131,column:11},end:{line:137,column:7}},{start:{line:131,column:11},end:{line:137,column:7}}],line:131},"19":{loc:{start:{line:149,column:2},end:{line:170,column:3}},type:"if",locations:[{start:{line:149,column:2},end:{line:170,column:3}},{start:{line:149,column:2},end:{line:170,column:3}}],line:149},"20":{loc:{start:{line:159,column:8},end:{line:167,column:9}},type:"if",locations:[{start:{line:159,column:8},end:{line:167,column:9}},{start:{line:159,column:8},end:{line:167,column:9}}],line:159},"21":{loc:{start:{line:162,column:13},end:{line:167,column:9}},type:"if",locations:[{start:{line:162,column:13},end:{line:167,column:9}},{start:{line:162,column:13},end:{line:167,column:9}}],line:162}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"1b6ac44bacba3be685a4741cdfa0626b4533e37f"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1cfddh0017=function(){return actualCoverage;};}return actualCoverage;}cov_1cfddh0017();var express=(cov_1cfddh0017().s[0]++,require('express'));const app=(cov_1cfddh0017().s[1]++,express());var router=(cov_1cfddh0017().s[2]++,express.Router());const{MongoClient}=(cov_1cfddh0017().s[3]++,require('mongodb'));let sanitize=(cov_1cfddh0017().s[4]++,require('mongo-sanitize'));let url=(cov_1cfddh0017().s[5]++,"mongodb://localhost:27017/");cov_1cfddh0017().s[6]++;app.use(express.json());cov_1cfddh0017().s[7]++;app.use(express.urlencoded({extended:false}));cov_1cfddh0017().s[8]++;router.all('/messages',function(req,res,next){cov_1cfddh0017().f[0]++;cov_1cfddh0017().s[9]++;if((cov_1cfddh0017().b[1][0]++,req.method=="POST")||(cov_1cfddh0017().b[1][1]++,req.method=="GET")){cov_1cfddh0017().b[0][0]++;cov_1cfddh0017().s[10]++;//Kolla om get har en body?
if((cov_1cfddh0017().b[3][0]++,req.method=="GET")&&(cov_1cfddh0017().b[3][1]++,req.body)){cov_1cfddh0017().b[2][0]++;cov_1cfddh0017().s[11]++;res.sendStatus(405);}else{cov_1cfddh0017().b[2][1]++;}cov_1cfddh0017().s[12]++;next();}else{cov_1cfddh0017().b[0][1]++;cov_1cfddh0017().s[13]++;//console.log(req.method)
res.sendStatus(405);}});cov_1cfddh0017().s[14]++;router.all('/messages/:id',function(req,res,next){cov_1cfddh0017().f[1]++;cov_1cfddh0017().s[15]++;//console.log("1")
if((cov_1cfddh0017().b[5][0]++,req.method=="PATCH")||(cov_1cfddh0017().b[5][1]++,req.method=="GET")){cov_1cfddh0017().b[4][0]++;cov_1cfddh0017().s[16]++;next();}else{cov_1cfddh0017().b[4][1]++;cov_1cfddh0017().s[17]++;res.sendStatus(405);}});//------------------------------------------------------------------
//Save one
cov_1cfddh0017().s[18]++;router.post('/messages',(req,res)=>{cov_1cfddh0017().f[2]++;cov_1cfddh0017().s[19]++;if(validateMsg(req.body)){cov_1cfddh0017().b[6][0]++;cov_1cfddh0017().s[20]++;msg=sanitize(req.body);const regex=(cov_1cfddh0017().s[21]++,new RegExp(/<script>/));//injection?
cov_1cfddh0017().s[22]++;if(!regex.test(msg)){cov_1cfddh0017().b[7][0]++;cov_1cfddh0017().s[23]++;//console.log(req.body)
MongoClient.connect(url,(err,db)=>{cov_1cfddh0017().f[3]++;let dbo=(cov_1cfddh0017().s[24]++,db.db("tdp013"));cov_1cfddh0017().s[25]++;dbo.collection('messages').insertOne(msg,function(err,result){cov_1cfddh0017().f[4]++;cov_1cfddh0017().s[26]++;if(err){cov_1cfddh0017().b[8][0]++;}else{cov_1cfddh0017().b[8][1]++;cov_1cfddh0017().s[27]++;db.close();cov_1cfddh0017().s[28]++;res.sendStatus(200);}});});}else{cov_1cfddh0017().b[7][1]++;cov_1cfddh0017().s[29]++;res.sendStatus(500);}}else{cov_1cfddh0017().b[6][1]++;cov_1cfddh0017().s[30]++;res.sendStatus(500);}});function validateMsg(body){cov_1cfddh0017().f[5]++;cov_1cfddh0017().s[31]++;if((cov_1cfddh0017().b[10][0]++,body.msg.length===0)||(cov_1cfddh0017().b[10][1]++,body.msg.length>140)){cov_1cfddh0017().b[9][0]++;cov_1cfddh0017().s[32]++;return false;}else{cov_1cfddh0017().b[9][1]++;}cov_1cfddh0017().s[33]++;if(!(typeof body.id=="number")){cov_1cfddh0017().b[11][0]++;cov_1cfddh0017().s[34]++;return false;}else{cov_1cfddh0017().b[11][1]++;}cov_1cfddh0017().s[35]++;if(typeof body.state!=="boolean"){cov_1cfddh0017().b[12][0]++;cov_1cfddh0017().s[36]++;return false;}else{cov_1cfddh0017().b[12][1]++;}cov_1cfddh0017().s[37]++;return true;}//------------------------------------------------------------------
//Mark read
cov_1cfddh0017().s[38]++;router.patch('/messages/:id',(req,res)=>{cov_1cfddh0017().f[6]++;let msgId=(cov_1cfddh0017().s[39]++,sanitize(req.params.id));//console.log("in patch function with value " + msgId)
const regex=(cov_1cfddh0017().s[40]++,new RegExp(/\D+/));cov_1cfddh0017().s[41]++;if(regex.test(msgId)){cov_1cfddh0017().b[13][0]++;cov_1cfddh0017().s[42]++;res.sendStatus(400);}else{cov_1cfddh0017().b[13][1]++;cov_1cfddh0017().s[43]++;MongoClient.connect(url,(err,db)=>{cov_1cfddh0017().f[7]++;let dbo=(cov_1cfddh0017().s[44]++,db.db("tdp013"));let myquery=(cov_1cfddh0017().s[45]++,{id:msgId});cov_1cfddh0017().s[46]++;dbo.collection("messages").findOne(myquery,function(err,result){cov_1cfddh0017().f[8]++;cov_1cfddh0017().s[47]++;if(err){cov_1cfddh0017().b[14][0]++;cov_1cfddh0017().s[48]++;res.sendStatus(500);}else{cov_1cfddh0017().b[14][1]++;cov_1cfddh0017().s[49]++;if(result!=null){cov_1cfddh0017().b[15][0]++;//If we find a result
let newvalues=(cov_1cfddh0017().s[50]++,{$set:{state:!result.state}});cov_1cfddh0017().s[51]++;dbo.collection("messages").updateOne(myquery,newvalues,function(err,result2){cov_1cfddh0017().f[9]++;cov_1cfddh0017().s[52]++;if(err){cov_1cfddh0017().b[16][0]++;cov_1cfddh0017().s[53]++;db.close();cov_1cfddh0017().s[54]++;res.sendStatus(500);}else{cov_1cfddh0017().b[16][1]++;cov_1cfddh0017().s[55]++;db.close();cov_1cfddh0017().s[56]++;res.sendStatus(200);}});}else{cov_1cfddh0017().b[15][1]++;cov_1cfddh0017().s[57]++;//If we dont find a result
res.sendStatus(500);cov_1cfddh0017().s[58]++;db.close();}}});});}});//------------------------------------------------------------------
//Get all
cov_1cfddh0017().s[59]++;router.get('/messages',(req,res)=>{cov_1cfddh0017().f[10]++;cov_1cfddh0017().s[60]++;MongoClient.connect(url,(err,db)=>{cov_1cfddh0017().f[11]++;let dbo=(cov_1cfddh0017().s[61]++,db.db("tdp013"));cov_1cfddh0017().s[62]++;dbo.collection('messages').find({}).toArray(function(err,result){cov_1cfddh0017().f[12]++;cov_1cfddh0017().s[63]++;db.close();cov_1cfddh0017().s[64]++;if(err){//console.log(err)
cov_1cfddh0017().b[17][0]++;}else{cov_1cfddh0017().b[17][1]++;cov_1cfddh0017().s[65]++;if(result!=null){cov_1cfddh0017().b[18][0]++;cov_1cfddh0017().s[66]++;//console.log(result)
res.send(result);}else{cov_1cfddh0017().b[18][1]++;cov_1cfddh0017().s[67]++;res.sendStatus(500);}}});});//res.send()
});//------------------------------------------------------------------
// Get one
cov_1cfddh0017().s[68]++;router.get('/messages/:id',(req,res)=>{cov_1cfddh0017().f[13]++;let msgId=(cov_1cfddh0017().s[69]++,sanitize(req.params.id));const regex=(cov_1cfddh0017().s[70]++,new RegExp(/\D+/));cov_1cfddh0017().s[71]++;if(regex.test(msgId)){cov_1cfddh0017().b[19][0]++;cov_1cfddh0017().s[72]++;res.sendStatus(400);}else{cov_1cfddh0017().b[19][1]++;cov_1cfddh0017().s[73]++;MongoClient.connect(url,(err,db)=>{cov_1cfddh0017().f[14]++;let dbo=(cov_1cfddh0017().s[74]++,db.db("tdp013"));let myquery=(cov_1cfddh0017().s[75]++,{id:msgId});cov_1cfddh0017().s[76]++;dbo.collection("messages").findOne(myquery,function(err,result){cov_1cfddh0017().f[15]++;cov_1cfddh0017().s[77]++;db.close();cov_1cfddh0017().s[78]++;if(err){//console.log(err)
cov_1cfddh0017().b[20][0]++;}else{cov_1cfddh0017().b[20][1]++;cov_1cfddh0017().s[79]++;if(result!=null){cov_1cfddh0017().b[21][0]++;cov_1cfddh0017().s[80]++;res.send(result);//.json(result)
}else{cov_1cfddh0017().b[21][1]++;cov_1cfddh0017().s[81]++;res.sendStatus(500);}}});});}});cov_1cfddh0017().s[82]++;app.use(function(req,res){cov_1cfddh0017().f[16]++;cov_1cfddh0017().s[83]++;//console.log("found it")
res.send("Sorry can't find that!",404);});cov_1cfddh0017().s[84]++;module.exports=router;/*använd asynkrona anrop för att hämta och lagra data. 
Kan ta in en resolve och reject funktion. 
Med detta kan vi skicka rätt felmeddelanden.
en backend fil som hanterar logik
en testfil som representerar klient-logiken 
(alltså om vi klickar på en knapp kommer meddelande x
skickas t.ex)*/
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwiYXBwIiwicm91dGVyIiwiUm91dGVyIiwiTW9uZ29DbGllbnQiLCJzYW5pdGl6ZSIsInVybCIsInVzZSIsImpzb24iLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJhbGwiLCJyZXEiLCJyZXMiLCJuZXh0IiwibWV0aG9kIiwiYm9keSIsInNlbmRTdGF0dXMiLCJwb3N0IiwidmFsaWRhdGVNc2ciLCJtc2ciLCJyZWdleCIsIlJlZ0V4cCIsInRlc3QiLCJjb25uZWN0IiwiZXJyIiwiZGIiLCJkYm8iLCJjb2xsZWN0aW9uIiwiaW5zZXJ0T25lIiwicmVzdWx0IiwiY2xvc2UiLCJsZW5ndGgiLCJpZCIsInN0YXRlIiwicGF0Y2giLCJtc2dJZCIsInBhcmFtcyIsIm15cXVlcnkiLCJmaW5kT25lIiwibmV3dmFsdWVzIiwiJHNldCIsInVwZGF0ZU9uZSIsInJlc3VsdDIiLCJnZXQiLCJmaW5kIiwidG9BcnJheSIsInNlbmQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiZzVaQWVZOzJGQWZaLEdBQUlBLENBQUFBLE9BQU8sMEJBQUdDLE9BQU8sQ0FBQyxTQUFELENBQVYsQ0FBWCxDQUNBLEtBQU1DLENBQUFBLEdBQUcsMEJBQUdGLE9BQU8sRUFBVixDQUFULENBQ0EsR0FBSUcsQ0FBQUEsTUFBTSwwQkFBR0gsT0FBTyxDQUFDSSxNQUFSLEVBQUgsQ0FBVixDQUNBLEtBQU0sQ0FBQ0MsV0FBRCwyQkFBZ0JKLE9BQU8sQ0FBQyxTQUFELENBQXZCLENBQU4sQ0FDQSxHQUFJSyxDQUFBQSxRQUFRLDBCQUFHTCxPQUFPLENBQUMsZ0JBQUQsQ0FBVixDQUFaLENBQ0EsR0FBSU0sQ0FBQUEsR0FBRywwQkFBRyw0QkFBSCxDQUFQLEMsd0JBRUFMLEdBQUcsQ0FBQ00sR0FBSixDQUFRUixPQUFPLENBQUNTLElBQVIsRUFBUixFLHdCQUNBUCxHQUFHLENBQUNNLEdBQUosQ0FBUVIsT0FBTyxD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a0MsSUFBSixDQUFTakIsTUFBVCxFQUFnQjtBQUNqQixDQUZJLElBR0Esc0RBQ0hqQixHQUFHLENBQUNJLFVBQUosQ0FBZSxHQUFmLEVBQ0QsRUFDRixDQVhELEVBWUQsQ0FoQkQsRUFpQkQsQ0FDRixDQXpCRCxFLHlCQTJCQWhCLEdBQUcsQ0FBQ00sR0FBSixDQUFRLFNBQVVLLEdBQVYsQ0FBZUMsR0FBZixDQUFvQixtREFDMUI7QUFDQUEsR0FBRyxDQUFDa0MsSUFBSixDQUFTLHdCQUFULENBQW1DLEdBQW5DLEVBQ0QsQ0FIRCxFLHlCQU1BQyxNQUFNLENBQUNDLE9BQVAsQ0FBaUIvQyxNQUFqQixDQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCBhcHAgPSBleHByZXNzKCk7XG52YXIgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcbmNvbnN0IHtNb25nb0NsaWVudH0gPSByZXF1aXJlKCdtb25nb2RiJyk7XG5sZXQgc2FuaXRpemUgPSByZXF1aXJlKCdtb25nby1zYW5pdGl6ZScpO1xubGV0IHVybCA9IFwibW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNy9cIjtcblxuYXBwLnVzZShleHByZXNzLmpzb24oKSk7XG5hcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiBmYWxzZSB9KSk7XG5cblxucm91dGVyLmFsbCgnL21lc3NhZ2VzJywgZnVuY3Rpb24ocmVxLCByZXMsIG5leHQpIHtcbiAgaWYocmVxLm1ldGhvZCA9PSBcIlBPU1RcIiB8fCByZXEubWV0aG9kID09IFwiR0VUXCIpIHtcbiAgICAvL0tvbGxhIG9tIGdldCBoYXIgZW4gYm9keT9cbiAgICBpZiAocmVxLm1ldGhvZCA9PSBcIkdFVFwiICYmIHJlcS5ib2R5KSB7XG4gICAgICAgIHJlcy5zZW5kU3RhdHVzKDQwNSlcbiAgICB9XG4gICAgbmV4dCgpO1xuICB9IGVsc2Uge1xuICAgIC8vY29uc29sZS5sb2cocmVxLm1ldGhvZClcbiAgICByZXMuc2VuZFN0YXR1cyg0MDUpXG4gIH1cbn0pXG5cbnJvdXRlci5hbGwoJy9tZXNzYWdlcy86aWQnLCBmdW5jdGlvbihyZXEsIHJlcywgbmV4dCkge1xuICAvL2NvbnNvbGUubG9nKFwiMVwiKVxuICBpZihyZXEubWV0aG9kID09IFwiUEFUQ0hcIiB8fCByZXEubWV0aG9kID09IFwiR0VUXCIpIHtcbiAgICBuZXh0KCk7XG4gIH0gZWxzZSB7XG4gICAgcmVzLnNlbmRTdGF0dXMoNDA1KVxuICB9XG59KVxuXG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vL1NhdmUgb25lXG5cbnJvdXRlci5wb3N0KCcvbWVzc2FnZXMnLCAocmVxLCByZXMpID0+IHtcbiAgaWYgKHZhbGlkYXRlTXNnKHJlcS5ib2R5KSkge1xuICAgIG1zZyA9IHNhbml0aXplKHJlcS5ib2R5KVxuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cCgvPHNjcmlwdD4vKSAgLy9pbmplY3Rpb24/XG4gICAgaWYgKCFyZWdleC50ZXN0KG1zZykpIHtcbiAgICAgIC8vY29uc29sZS5sb2cocmVxLmJvZHkpXG4gICAgICBNb25nb0NsaWVudC5jb25uZWN0KHVybCwgKGVyciwgZGIpID0+IHtcbiAgICAgICAgbGV0IGRibyA9IGRiLmRiKFwidGRwMDEzXCIpO1xuICAgICAgICBkYm8uY29sbGVjdGlvbignbWVzc2FnZXMnKS5pbnNlcnRPbmUobXNnLCBmdW5jdGlvbihlcnIsIHJlc3VsdCkge1xuICAgICAgICAgIGlmIChlcnIpIHt9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBkYi5jbG9zZSgpO1xuICAgICAgICAgICAgcmVzLnNlbmRTdGF0dXMoMjAwKVxuICAgICAgICAgIH1cblxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHJlcy5zZW5kU3RhdHVzKDUwMClcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmVzLnNlbmRTdGF0dXMoNTAwKVxuICB9XG4gIFxufSlcblxuZnVuY3Rpb24gdmFsaWRhdGVNc2coYm9keSkge1xuXG4gIGlmIChib2R5Lm1zZy5sZW5ndGggPT09IDAgfHwgYm9keS5tc2cubGVuZ3RoID4gMTQwKSB7IHJldHVybiBmYWxzZSB9XG4gIGlmICghKHR5cGVvZihib2R5LmlkKSA9PSBcIm51bWJlclwiKSkgICAgICAgICAgICAgICAgICAgICAgICB7IHJldHVybiBmYWxzZSB9XG4gIGlmICh0eXBlb2YoYm9keS5zdGF0ZSkgIT09IFwiYm9vbGVhblwiKSAgICAgICAgICAgICAgICAgeyByZXR1cm4gZmFsc2UgfVxuICByZXR1cm4gdHJ1ZVxufVxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy9NYXJrIHJlYWRcbnJvdXRlci5wYXRjaCgoJy9tZXNzYWdlcy86aWQnKSwgKHJlcSwgcmVzKSA9PiB7XG5cbiAgbGV0IG1zZ0lkID0gc2FuaXRpemUocmVxLnBhcmFtcy5pZClcbiAgLy9jb25zb2xlLmxvZyhcImluIHBhdGNoIGZ1bmN0aW9uIHdpdGggdmFsdWUgXCIgKyBtc2dJZClcbiAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKC9cXEQrLylcblxuICBpZiAocmVnZXgudGVzdChtc2dJZCkpIHtcbiAgICByZXMuc2VuZFN0YXR1cyg0MDApXG5cbiAgfSBlbHNlIHtcbiAgICBNb25nb0NsaWVudC5jb25uZWN0KHVybCwgKGVyciwgZGIpID0+IHtcbiAgICAgIGxldCBkYm8gPSBkYi5kYihcInRkcDAxM1wiKTtcbiAgICAgIGxldCBteXF1ZXJ5ID0geyBpZDogbXNnSWQgfTtcbiAgICAgIFxuICAgICAgZGJvLmNvbGxlY3Rpb24oXCJtZXNzYWdlc1wiKS5maW5kT25lKG15cXVlcnksIGZ1bmN0aW9uKGVyciwgcmVzdWx0KSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICByZXMuc2VuZFN0YXR1cyg1MDApXG4gICAgICAgIH0gXG4gICAgICAgIGVsc2UgaWYgKHJlc3VsdCAhPSBudWxsKSB7XG4gICAgICAgICAgLy9JZiB3ZSBmaW5kIGEgcmVzdWx0XG4gICAgICAgICAgbGV0IG5ld3ZhbHVlcyA9IHsgJHNldDoge3N0YXRlOiAhKHJlc3VsdC5zdGF0ZSl9IH07XG4gICAgICAgICAgXG4gICAgICAgICAgZGJvLmNvbGxlY3Rpb24oXCJtZXNzYWdlc1wiKS51cGRhdGVPbmUobXlxdWVyeSwgbmV3dmFsdWVzLCBmdW5jdGlvbihlcnIsIHJlc3VsdDIpIHtcbiAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgZGIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgcmVzLnNlbmRTdGF0dXMoNTAwKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgICAgICAgIHJlcy5zZW5kU3RhdHVzKDIwMClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy9JZiB3ZSBkb250IGZpbmQgYSByZXN1bHRcbiAgICAgICAgICByZXMuc2VuZFN0YXR1cyg1MDApXG4gICAgICAgICAgZGIuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBcbiAgICB9KTtcbiAgfVxufSlcblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vR2V0IGFsbFxucm91dGVyLmdldCgoJy9tZXNzYWdlcycpLCAocmVxLCByZXMpID0+IHtcblxuICBNb25nb0NsaWVudC5jb25uZWN0KHVybCwgKGVyciwgZGIpID0+IHtcbiAgICBsZXQgZGJvID0gZGIuZGIoXCJ0ZHAwMTNcIik7XG5cbiAgICBkYm8uY29sbGVjdGlvbignbWVzc2FnZXMnKS5maW5kKHt9KS50b0FycmF5KGZ1bmN0aW9uKGVyciwgcmVzdWx0KSB7XG4gICAgICBkYi5jbG9zZSgpO1xuICAgICAgaWYgKGVycikge1xuICAgICAgICAvL2NvbnNvbGUubG9nKGVycilcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHJlc3VsdCAhPSBudWxsKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2cocmVzdWx0KVxuICAgICAgICByZXMuc2VuZChyZXN1bHQpXG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgcmVzLnNlbmRTdGF0dXMoNTAwKVxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gIH0pXG4gIC8vcmVzLnNlbmQoKVxufSlcblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIEdldCBvbmVcbnJvdXRlci5nZXQoKCcvbWVzc2FnZXMvOmlkJyksIChyZXEsIHJlcykgPT4ge1xuICBsZXQgbXNnSWQgPSBzYW5pdGl6ZShyZXEucGFyYW1zLmlkKVxuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoL1xcRCsvKVxuICBpZiAocmVnZXgudGVzdChtc2dJZCkpIHtcbiAgICByZXMuc2VuZFN0YXR1cyg0MDApXG4gIH0gZWxzZSB7XG5cbiAgICBNb25nb0NsaWVudC5jb25uZWN0KHVybCwgKGVyciwgZGIpID0+IHtcbiAgICAgIGxldCBkYm8gPSBkYi5kYihcInRkcDAxM1wiKTtcbiAgICAgIGxldCBteXF1ZXJ5ID0geyBpZDogbXNnSWQgfTtcblxuICAgICAgZGJvLmNvbGxlY3Rpb24oXCJtZXNzYWdlc1wiKS5maW5kT25lKG15cXVlcnksIGZ1bmN0aW9uKGVyciwgcmVzdWx0KSB7XG4gICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAvL2NvbnNvbGUubG9nKGVycilcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChyZXN1bHQgIT0gbnVsbCkge1xuICAgICAgICAgIHJlcy5zZW5kKHJlc3VsdCkvLy5qc29uKHJlc3VsdClcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICByZXMuc2VuZFN0YXR1cyg1MDApXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59KVxuXG5hcHAudXNlKGZ1bmN0aW9uIChyZXEsIHJlcykge1xuICAvL2NvbnNvbGUubG9nKFwiZm91bmQgaXRcIilcbiAgcmVzLnNlbmQoXCJTb3JyeSBjYW4ndCBmaW5kIHRoYXQhXCIsIDQwNClcbn0pXG5cblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XG5cblxuLyphbnbDpG5kIGFzeW5rcm9uYSBhbnJvcCBmw7ZyIGF0dCBow6RtdGEgb2NoIGxhZ3JhIGRhdGEuIFxuS2FuIHRhIGluIGVuIHJlc29sdmUgb2NoIHJlamVjdCBmdW5rdGlvbi4gXG5NZWQgZGV0dGEga2FuIHZpIHNraWNrYSByw6R0dCBmZWxtZWRkZWxhbmRlbi5cbmVuIGJhY2tlbmQgZmlsIHNvbSBoYW50ZXJhciBsb2dpa1xuZW4gdGVzdGZpbCBzb20gcmVwcmVzZW50ZXJhciBrbGllbnQtbG9naWtlbiBcbihhbGx0c8OlIG9tIHZpIGtsaWNrYXIgcMOlIGVuIGtuYXBwIGtvbW1lciBtZWRkZWxhbmRlIHhcbnNraWNrYXMgdC5leCkqL1xuIl19